<!DOCTYPE html>
<html>
  <head>
    <title><%= "SwiftPick" %></title>
    <link rel="icon" href="<%= image_url('logo.png') %>" type="image/png">

    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- Your app stylesheet -->
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Rails importmap / JS -->
    <%= javascript_importmap_tags %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module" %>
  </head>
   <body>
     <!-- Notification Container -->
      <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 9999;">
        <% if flash[:notice] %>
          <div id="noticeToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="3000">
            <div class="toast-header bg-success text-white">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-circle me-2" viewBox="0 0 16 16">
                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 2.604 6.3a.75.75 0 0 0-1.06 1.06l4.9 4.9a.75.75 0 0 0 1.234-.065l3.75-5.25a.75.75 0 0 0-1.359-.234z"/>
              </svg>
              <strong class="me-auto">Success</strong>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
              <%= flash[:notice] %>
            </div>
          </div>
        <% end %>
        
        <% if flash[:alert] %>
          <div id="alertToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="4000">
            <div class="toast-header bg-danger text-white">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-circle me-2" viewBox="0 0 16 16">
                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                <path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/>
              </svg>
              <strong class="me-auto">Error</strong>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
              <%= flash[:alert] %>
            </div>
          </div>
        <% end %>
      </div>
    <% if show_navbar? %>
    <header>
      <!-- Top Navbar -->
      <nav class="navbar navbar-expand-lg navbar-dark bg-black py-2">
        <div class="container-fluid px-4">
          <%= link_to root_path, class: "navbar-brand d-flex align-items-center me-4" do %>
            <%= image_tag "larg logo.png",
                    class: "img-fluid rounded",
                    style: "height:40px; object-fit:cover;" %>
          <% end %>

          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#topNavbar" aria-controls="topNavbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="topNavbar">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item"><%= link_to "Home", root_path, class: "nav-link px-3" %></li>
              <li class="nav-item"><%= link_to "About Us", root_path, class: "nav-link px-3" %></li>
              <li class="nav-item"><%= link_to "Contact", root_path, class: "nav-link px-3" %></li>
            </ul>

            <form class="d-flex me-3" method="get" action="<%= products_path %>">
              <input class="form-control me-2"
                type="search"
                name="query"
                placeholder="Search products or categories"
                value="<%= params[:query] %>"
                style="min-width: 300px;">
              <button class="btn btn-outline-light" type="submit">
                Search
              </button>
            </form>

            <div class="d-flex align-items-center">
              <% unless current_user %>
                <%= link_to "Login", login_path, class: "btn btn-outline-light" %>
              <% end %>

              <%= link_to cart_path, class: "d-flex align-items-center text-decoration-none ms-3 position-relative" do %>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" class="bi bi-cart" viewBox="0 0 16 16">
                  <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0z"/>
                </svg>
              <% end %>
            </div>
          </div>
        </div>
      </nav>

      <!-- Secondary Navbar -->
      <nav class="navbar navbar-expand-lg navbar-dark py-2" style="background-color: #32323D">
        <div class="container-fluid px-4">
          <ul class="navbar-nav d-flex flex-row align-items-center mb-2 mb-lg-0 w-100">
            <% if current_user %>
            <li class="nav-item d-flex align-items-center">
                <button
                  class="btn btn-link nav-link text-white px-3 py-1 border-0 d-flex align-items-center gap-1"
                  type="button" id="allMenuBtn" style="text-decoration: none; font-weight: 500;">
                  <svg
                    width="25"
                    height="25"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="white">
                    <path d="m21 15.75c0-.414-.336-.75-.75-.75h-16.5c-.414 0-.75.336-.75.75s.336.75.75.75h16.5c.414 0 .75-.336.75-.75zm0-4c0-.414-.336-.75-.75-.75h-16.5c-.414 0-.75.336-.75.75s.336.75.75.75h16.5c.414 0 .75-.336.75-.75zm0-4c0-.414-.336-.75-.75-.75h-16.5c-.414 0-.75.336-.75.75s.336.75.75.75h16.5c.414 0 .75-.336.75-.75z"/>
                  </svg>
                  All
                </button>
              </li>
            <% end %>
            <li class="nav-item"><%= link_to "Customer Service", root_path, class: "nav-link px-3 py-1" %></li>
          </ul>
        </div>
      </nav>

      <!-- Sidebar -->
      <% if current_user %>
        <div class="offcanvas offcanvas-start" tabindex="-1" id="userSidebar" aria-labelledby="userSidebarLabel" style="width: 300px;">
          <div class="offcanvas-header">
            <div class="d-flex align-items-center justify-content-between w-100">
              <h6 class="mb-0">Hello, <%= current_user.name || current_user.email %></h6>
              <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
          </div>
          <div class="offcanvas-body">
            <hr class="my-3">
            <div class="list-group list-group-flush">
              <a href="<%= profile_path %>" class="list-group-item list-group-item-action border-0 px-0 py-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person me-2" viewBox="0 0 16 16">
                  <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                </svg>
                Profile
              </a>
              <a href="<%= customer_orders_path %>" class="list-group-item list-group-item-action border-0 px-0 py-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bag me-2" viewBox="0 0 16 16">
                  <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z"/>
                </svg>
                Orders
              </a>
            </div>
            <hr class="my-3">
            <div class="mt-auto">
              <%= button_to logout_path, method: :delete, class: "btn btn-outline-danger w-100" do %>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-right me-2" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"/>
                  <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
                </svg>
                Logout
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </header>
    <% end %>

    
      <main>
        <%= yield %>
      </main>

      <% if show_navbar? %>
      <!-- Footer -->
      <footer class="bg-dark text-white">
        <div class="container ">
          <div class="row g-4">
            <!-- Company Info -->
            <div class="col-lg-4 col-md-6 mb-4 mb-lg-0">
              <h5 class="mb-3 text-white">SwiftPick</h5>
              <p class="text-white mb-3">
                Your one-stop destination for quality products at great prices. Shop with confidence and enjoy fast delivery.
              </p>
              <div class="d-flex gap-3">
                <a href="#" class="text-white text-decoration-none">Facebook</a>
                <a href="#" class="text-white text-decoration-none">Twitter</a>
                <a href="#" class="text-white text-decoration-none">Instagram</a>
                <a href="#" class="text-white text-decoration-none">LinkedIn</a>
              </div>
            </div>
            
            <!-- Customer Service -->
            <div class="col-lg-4 col-md-6 mb-4 mb-lg-0">
              <h6 class="mb-3 text-white">Customer Service</h6>
              <ul class="list-unstyled">
                <li class="mb-2"><a href="#" class="text-white text-decoration-none">Help Center</a></li>
                <li class="mb-2"><a href="#" class="text-white text-decoration-none">Shipping Info</a></li>
                <li class="mb-2"><a href="#" class="text-white text-decoration-none">Returns</a></li>
                <li class="mb-2"><a href="#" class="text-white text-decoration-none">FAQ</a></li>
              </ul>
            </div>
            
            <!-- Contact Info -->
            <div class="col-lg-4 col-md-6">
              <h6 class="mb-3 text-white">Contact Us</h6>
              <ul class="list-unstyled text-white">
                <li class="mb-2">
                  123 Shopping Street, City, Country
                </li>
                <li class="mb-2">
                  +923456789234
                </li>
                <li class="mb-2">
                  support@swiftpick.com
                </li>
              </ul>
            </div>
          </div>
          
          <hr class="bg-secondary my-4">
          
          <!-- Copyright -->
          <div class="row align-items-center">
            <div class="col-md-6 mb-3 mb-md-0">
              <p class="text-white mb-0">
                &copy; <%= Time.current.year %> SwiftPick. All rights reserved.
              </p>
            </div>
            <div class="col-md-6 text-md-end">
              <a href="#" class="text-white text-decoration-none me-3">Privacy Policy</a>
              <a href="#" class="text-white text-decoration-none me-3">Terms of Service</a>
              <a href="#" class="text-white text-decoration-none">Cookie Policy</a>
            </div>
          </div>
        </div>
      </footer>
      <% end %>

      <!-- Bootstrap JS Bundle -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      function showToasts() {
        document.querySelectorAll('.toast').forEach(function (toastEl) {
          new bootstrap.Toast(toastEl).show();
        });
      }

      document.addEventListener('DOMContentLoaded', showToasts);
      document.addEventListener('turbo:load', showToasts);

      // Sidebar functionality
      document.addEventListener('DOMContentLoaded', function() {
        const allMenuBtn = document.getElementById('allMenuBtn');
        const userSidebar = document.getElementById('userSidebar');

        if (allMenuBtn && userSidebar) {
          allMenuBtn.addEventListener('click', function() {
            const offcanvas = new bootstrap.Offcanvas(userSidebar);
            offcanvas.show();
          });
        }
      });
    </script>


      
  </body>
</html>