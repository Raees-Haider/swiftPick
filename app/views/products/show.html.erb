<div class="container mt-4 mb-5">
  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><%= link_to "Home", root_path, class: "text-decoration-none" %></li>
      <li class="breadcrumb-item"><%= link_to "Products", products_path, class: "text-decoration-none" %></li>
      <li class="breadcrumb-item active" aria-current="page"><%= truncate(@product.name, length: 30) %></li>
    </ol>
  </nav>

  <div class="row g-4">
    <!-- Product Image -->
    <div class="col-lg-6">
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4 text-center">
          <% if @product.image.attached? %>
            <%= image_tag url_for(@product.image),
                  class: "img-fluid",
                  style: "max-height: 500px; width: auto; object-fit: contain;",
                  alt: @product.name %>
          <% else %>
            <%= image_tag "placeholder.png",
                  class: "img-fluid",
                  style: "max-height: 500px; width: auto; object-fit: contain;",
                  alt: "Placeholder" %>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Product Details -->
    <div class="col-lg-6">
      <!-- Product Title -->
      <h1 class="mb-2" style="font-size: 1.75rem; line-height: 1.3;"><%= @product.name %></h1>

      <!-- Stock Status -->
      <div class="mb-3">
        <% if @product.stock_quantity == 0 %>
          <span class="badge bg-danger fs-6">Out of Stock</span>
        <% elsif @product.stock_quantity <= 10 %>
          <span class="badge bg-warning text-dark fs-6"><%= @product.stock_quantity %> items left</span>
        <% else %>
          <span class="badge bg-success fs-6">In Stock</span>
        <% end %>
      </div>

      <hr>

      <div class="mb-4">
        <h2 class="text-primary mb-0" style="font-size: 2rem;">Rs <%= @product.price.round(2) %></h2>
      </div>

      <hr>

      <div class="d-grid gap-2 mb-4">
        <%= button_to "Add to Cart",
              cart_cart_items_path(product_id: @product.id),
              method: :post,
              id: "add-to-cart-btn",
              class: "btn btn-warning btn-lg fw-bold w-100",
              style: "background-color: #ffc107; border: none;",
              disabled: @product.stock_quantity == 0 %>
      </div>

      <hr>

      <!-- Product Description -->
      <div class="mt-4">
        <h5 class="mb-3">Product Description</h5>
        <p class="text-muted" style="line-height: 1.8;"><%= @product.description %></p>
      </div>

      <!-- Product Details Table -->
      <div class="mt-4">
        <h5 class="mb-3">Product Details</h5>
        <table class="table table-bordered">
          <tbody>
            <tr>
              <td class="fw-bold bg-light" style="width: 30%;">Name</td>
              <td><%= @product.name %></td>
            </tr>
            <tr>
              <td class="fw-bold bg-light">Price</td>
              <td>Rs <%= @product.price.round(2) %></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Related Products -->
  <% if @related_products.any? %>
    <div class="row mt-5">
      <div class="col-12">
        <h3 class="mb-4">You may also like</h3>
        <div class="row g-4">
          <% @related_products.each do |product| %>
            <div class="col-lg-3 col-md-4 col-sm-6">
              <div class="card h-100 shadow-sm">
                <%= link_to product_path(product), class: "text-decoration-none" do %>
                  <% if product.image.attached? %>
                    <%= image_tag url_for(product.image),
                          class: "card-img-top object-fit-contain",
                          style: "height: 220px;",
                          alt: product.name %>
                  <% end %>
                  <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-dark"><%= truncate(product.name, length: 50) %></h5>
                    <p class="text-primary fw-bold mt-auto mb-0">Rs <%= product.price.round(2) %></p>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>

